# Buffer Overflow Exploits and Mitigation
Includes vulnerable C programs, x86 exploit opcode for the Netwide assembler.

- The Netwide Assembler is an assembler and disassembler for the Intel x86 architecture. It can be used to write 16-bit, 32-bit and 64-bit programs.

### Docker Instructions

- Build the Docker image using the following command in the same directory where the Dockerfile is located:

```
docker build -t ubuntu_image .
```

- Once the image is built, you can run a container based on this image. This command will start a new container with the Ubuntu image containing Emacs and the specified options enabled. 

```
docker run -it ubuntu_image
```
- To start a docker container and copy folder from macOS host machine to container
```
docker exec -it strange_cohen /bin/bash
docker cp /Users/ryanribeiro/Desktop/bufferdemo strange_cohen:app
```
---


### GNU Debugger
- Once gdb is installed, you should be able to use it to debug the core dump. For example:

```
gdb <executable_file> <core_dump_file>
```
- To enable debugging symbols during compilation:
  
```
gcc -g -o bufferOverflow bufferOverflow.c
```
---
### Disable stack smashing protection

- To disable stack smashing protection, you can use the ```-fno-stack-protector``` flag during compilation. This flag tells the compiler not to insert stack protection mechanisms, such as stack canaries, into the binary.

```
gcc bufferOverflow.c -o bufferOverflow -g -fno-stack-protector -z execstack -m32
```
---
### Dockerfile

- 32-bit cross-compilation specifically refers to compiling software on a 64-bit system for a 32-bit target architecture.
- You need to have installed the gcc-multilib package in order to do 32 bit cross-compilation. The package is already included in the Ubuntu image.

### Segmentation Core dumps and Allowing Buffer overflows 

- Run on the ubuntu terminal the following commands
- The noexec32 feature is related to security and memory protection. When enabled, it prevents the execution of code on memory pages that are marked as writable.

```
GRUB_CMDLINE_LINUX="find_preseed=/preseed.cfg auto noprompt priority=critical locale=en_US noexec=off noexec32=off"
```

### Disable ASLR inside Docker container
[GitHub Gist](https://gist.github.com/BretFisher/5e1a0c7bcca4c735e716abf62afad389)

```
# enter docker vm
docker run -it --rm --privileged --pid=host justincormack/nsenter1
# disable ASLR
echo 0  > /proc/sys/kernel/randomize_va_space 
# enable ASLR
echo 2  > /proc/sys/kernel/randomize_va_space 
```
- Enable core dumps
```
echo "kernel.core_pattern=core" > /etc/sysctl.d/core_pattern.conf
```

- Set ulimit to enable core dumps
```
ulimit -c unlimited
```

DO NOT RUN IN THIS STATE IN PRODUCTION

