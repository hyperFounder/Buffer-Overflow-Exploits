# Use the official Ubuntu image as the base image
FROM ubuntu:latest

# Update package lists and install required packages
RUN apt-get update && \
    apt-get install -y gcc-multilib && \
    apt-get install -y emacs && \
    apt-get install -y procps && \
    apt-get install -y build-essential && \
    apt-get install -y gdb

# Edit GRUB configuration to add noexec
RUN GRUB_CMDLINE_LINUX="find_preseed=/preseed.cfg auto noprompt priority=critical locale=en_US noexec=off noexec32=off"

# Enable core dumps
RUN echo "kernel.core_pattern=core" > /etc/sysctl.d/core_pattern.conf

# Turn off randomize space
RUN echo "kernel.randomize_va_space=0" > /etc/sysctl.d/randomize_va_space.conf

# Set ulimit to enable core dumps
RUN ulimit -c unlimited
